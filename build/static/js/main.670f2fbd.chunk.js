(this["webpackJsonpex-20-21"]=this["webpackJsonpex-20-21"]||[]).push([[0],{27:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(18),s=n.n(c),i=n(20),u=n(19),o=n(3),l=n(4),d=n(2),b=n.n(d),j=n(0),p=function(e){var t=e.blog,n=e.likeButtonHandler,c=e.removeButtonHandler,s=Object(r.useState)(!1),i=Object(l.a)(s,2),u=i[0],d=i[1],p=function(){var e=Object(o.a)(b.a.mark((function e(){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={user:t.user.id,likes:t.likes+1,author:t.author,title:t.title,url:t.url},e.next=3,n(r,t.id);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(j.jsxs)("div",{style:{paddingTop:10,paddingBottom:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},className:"blog",children:[Object(j.jsxs)("div",{className:"title",children:[t.title," ",Object(j.jsx)("button",{className:"viewButton",style:{marginLeft:10},onClick:function(){d(!u)},children:u?"hide":"view"})]}),Object(j.jsxs)("div",{className:"author",children:["by ",t.author]}),u?Object(j.jsxs)(a.a.Fragment,{children:[Object(j.jsx)("p",{className:"url",children:t.url}),Object(j.jsxs)("p",{className:"likes",children:["likes ",t.likes]}),Object(j.jsx)("button",{className:"likeButton",onClick:p,children:"like"}),Object(j.jsx)("div",{children:Object(j.jsx)("button",{onClick:c,children:"remove"})})]}):null]})},f=function(e){var t=e.username,n=e.password,r=e.onUsernameChange,c=e.onPasswordChange,s=e.loginFormSubmitHandler;return Object(j.jsxs)(a.a.Fragment,{children:[Object(j.jsx)("h2",{children:"login to application"}),Object(j.jsxs)("form",{id:"login",onSubmit:s,children:[Object(j.jsxs)("div",{children:["username ",Object(j.jsx)("input",{id:"username",name:"username",value:t,onChange:r})]}),Object(j.jsxs)("div",{children:["password ",Object(j.jsx)("input",{id:"password",name:"password",type:"password",value:n,onChange:c})]}),Object(j.jsx)("button",{id:"submit",type:"submit",children:"login"})]})]})},m=(n(27),function(e){var t=e.positive,n=e.message;return Object(j.jsx)("div",{id:"notification",className:t?"positive":"negative",children:n})}),h=a.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(l.a)(n,2),s=c[0],i=c[1],u={display:s?"":"none"},o={display:s?"none":""},d=function(){i(!s),e.resetFn()};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:d}})),Object(j.jsxs)(a.a.Fragment,{children:[Object(j.jsx)("div",{style:o,children:Object(j.jsx)("button",{onClick:d,children:e.showContentButtonLabel})}),Object(j.jsxs)("div",{style:u,children:[e.children,Object(j.jsx)("button",{onClick:d,children:e.hideContentButtonLabel})]})]})}));h.displayName="Togglable";var v=h,g=a.a.forwardRef((function(e,t){var n=Object(r.useState)(""),c=Object(l.a)(n,2),s=c[0],i=c[1],u=Object(r.useState)(""),o=Object(l.a)(u,2),d=o[0],b=o[1],p=Object(r.useState)(""),f=Object(l.a)(p,2),m=f[0],h=f[1],g=Object(r.useRef)(),O=function(){i(""),b(""),h("")};Object(r.useImperativeHandle)(t,(function(){return{resetCreateNewForm:O,createNewFormRef:g}}));var x=function(e){return function(t){e(t.target.value)}};return Object(j.jsx)(a.a.Fragment,{children:Object(j.jsxs)(v,{showContentButtonLabel:"Create New Blog",hideContentButtonLabel:"Cancel",resetFn:O,ref:g,children:[Object(j.jsx)("h2",{children:"create new"}),Object(j.jsxs)("form",{className:"createNewForm",onSubmit:e.createNewBlogSubmitHandler,children:[Object(j.jsx)("label",{htmlFor:"title",children:"title:"}),Object(j.jsx)("input",{type:"text",id:"title",name:"title",value:s,onChange:x(i)}),Object(j.jsx)("label",{htmlFor:"author",children:"author:"}),Object(j.jsx)("input",{type:"text",id:"author",name:"author",value:d,onChange:x(b)}),Object(j.jsx)("label",{htmlFor:"url",children:"url:"}),Object(j.jsx)("input",{type:"text",id:"url",name:"url",value:m,onChange:x(h)}),Object(j.jsx)("button",{type:"submit",children:"Create"})]})]})})}));g.displayName="CreateNewBlogForm";var O=g,x=function(e){var t=e.name,n=e.logoutButtonHandler;return Object(j.jsxs)(a.a.Fragment,{children:[Object(j.jsx)("h2",{children:"blogs"}),Object(j.jsxs)("p",{id:"logged_in_user",children:[" ",t," logged in ",Object(j.jsx)("button",{id:"logout",onClick:n,children:"logout"})]}),Object(j.jsx)("br",{})]})},w=n(6),k=n.n(w),y=function(){var e=Object(o.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"post",url:"/api/login",data:t},e.next=3,k()(n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C={login:y},B="/api/blogs",N=function(){var e=Object(o.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"get",url:B},e.next=3,k()(t);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(o.a)(b.a.mark((function e(t,n){var r,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"post",url:B,headers:{Authorization:"bearer ".concat(n)},data:t},e.next=3,k()(r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),F=function(){var e=Object(o.a)(b.a.mark((function e(t,n,r){var a,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"put",url:"".concat(B,"/").concat(r),headers:{Authorization:"bearer ".concat(n)},data:t},e.next=3,k()(a);case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),H=function(){var e=Object(o.a)(b.a.mark((function e(t,n){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"delete",url:"".concat(B,"/").concat(t),headers:{Authorization:"bearer ".concat(n)}},e.next=3,k()(r);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),A={getAll:N,createNew:S,updateABlogEntry:F,removeBlog:H},L=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)(""),d=Object(l.a)(s,2),h=d[0],v=d[1],g=Object(r.useState)(""),w=Object(l.a)(g,2),k=w[0],y=w[1],B=Object(r.useState)(null),N=Object(l.a)(B,2),S=N[0],F=N[1],H=Object(r.useState)(null),L=Object(l.a)(H,2),I=L[0],R=L[1],E=Object(r.useRef)(),J=function(){var e=Object(o.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={title:t.target.title.value,author:t.target.author.value,url:t.target.url.value},e.next=4,z(n);case 4:E.current.resetCreateNewForm(),E.current.createNewFormRef.current.toggleVisibility();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(o.a)(b.a.mark((function e(t){var r,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.createNew(t,S.token);case 3:(r=e.sent).user={id:S.id,name:S.name,username:S.username},a=[].concat(Object(u.a)(n),[r]),c(a),T({positive:!0,message:"New blog ".concat(t.title," by ").concat(t.author," added.")}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),T({positive:!1,message:"Adding new blog failed."});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),T=function(e){R(e),setTimeout((function(){R(null)}),3e3)},D=function(){F(null),window.localStorage.removeItem("user")},P=function(){var e=Object(o.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={username:t.target.username.value,password:t.target.password.value},v(""),y(""),e.prev=4,e.next=7,C.login(n);case 7:r=e.sent,window.localStorage.setItem("user",JSON.stringify(r)),F(r),T({positive:!0,message:"".concat(r.username," logged in.")}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),T({positive:!1,message:"Log in failed."});case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}(),U=function(e){v(e.target.value)},V=function(e){y(e.target.value)};Object(r.useEffect)((function(){Object(o.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S){e.next=7;break}return e.next=3,A.getAll();case 3:t=e.sent,c(t.sort((function(e,t){return e.likes-t.likes}))),e.next=8;break;case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))()}),[S]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("user");e&&F(JSON.parse(e))}),[]);var _=function(){var e=Object(o.a)(b.a.mark((function e(t,r){var a,s,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.updateABlogEntry(t,S.token,r);case 2:a=e.sent,s=n.map((function(e){return Object(i.a)({},e)})),u=s.find((function(e){return 0===e.id.localeCompare(a.id)})),u.likes=a.likes,c(s);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(j.jsxs)("div",{children:[I?Object(j.jsx)(m,{positive:I.positive,message:I.message}):null,S?Object(j.jsxs)(a.a.Fragment,{children:[Object(j.jsx)(x,{name:S.name,logoutButtonHandler:D}),Object(j.jsx)(O,{createNewBlogSubmitHandler:J,ref:E}),Object(j.jsx)("div",{id:"blogs",children:n.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(j.jsx)(p,{blog:e,likeButtonHandler:_,removeButtonHandler:(t=e.id,Object(o.a)(b.a.mark((function e(){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,window.confirm("Are you sure?")){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,A.removeBlog(t,S.token);case 6:r=n.filter((function(e){return 0!==e.id.localeCompare(t)})),c(r),T({positive:!0,message:"Blog deleted successfully!!"}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),T({positive:!1,message:"Blog deletion failed!!"});case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))))},e.id);var t}))})]}):Object(j.jsx)(f,{username:h,password:k,onUsernameChange:U,onPasswordChange:V,loginFormSubmitHandler:P})]})};s.a.render(Object(j.jsx)(L,{}),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.670f2fbd.chunk.js.map